{% extends 'modals/modal_form_base.html' %}
{% load i18n app_filters %}

{% block modal_title %}
    {% if form.instance.pk %}✏️ {% trans 'Редактировать задачу' %}{% else %}➕ {% trans 'Создать задачу' %}{% endif %}
{% endblock %}

{% block form_action %} 
    {% if form.instance.pk %}{% url 'crm_core:task_update' form.instance.pk %}{% else %}{% url 'crm_core:task_create' %}{% endif %}
{% endblock %}

{% block form_target %} #task-list {% endblock %}
{% block form_swap %} beforeend {% endblock %}

{% block form_fields %}
    {% if form.errors %}
        <div class="bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 p-3 rounded-lg shadow text-sm">
            <strong>⚠️ {% trans "Ошибка!" %}</strong> {% trans "Пожалуйста, исправьте ошибки ниже." %}
        </div>
    {% endif %}

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-3 w-full">
        {% for field in form %}
            <div class="col-span-2 sm:col-span-1 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 shadow focus-within:ring-2 focus-within:ring-blue-500 transition">
                <label for="{{ field.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300">
                    {{ field.label }}
                </label>
                <div class="mt-1">
                    {{ field }}
                    {% if field.errors %}
                        <ul class="mt-1 text-xs text-red-500 dark:text-red-400">
                            {% for error in field.errors %}
                                <li>⚠️ {{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}
