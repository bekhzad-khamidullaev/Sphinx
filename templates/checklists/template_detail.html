{% extends 'base.html' %}
{% load i18n static %}

{% block title %}{% trans "Шаблон чеклиста" %}: {{ template.name }}{% endblock %}

{% block list_title %}
<div class="flex items-center justify-between flex-wrap gap-4">
    <div>
        <h1 class="text-2xl font-semibold text-gray-900 dark:text-gray-100 sm:text-3xl">
            {{ template.name }}
        </h1>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
           {% if template.category %}{% trans 'Категория' %}: {{ template.category.name }}{% else %}{% trans 'Без категории' %}{% endif %}
           <span class="mx-2 text-gray-300 dark:text-gray-600">|</span>
           {% if template.is_active %}
               <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300">
                   <i class="fas fa-check mr-1"></i>{% trans 'Активен' %}
               </span>
           {% else %}
                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300">
                    <i class="fas fa-times mr-1"></i>{% trans 'Неактивен' %}
               </span>
           {% endif %}
        </p>
    </div>
    {# Action Buttons Section #}
    <div class="flex flex-wrap gap-2 sm:gap-3 flex-shrink-0">
        {# Perform Button (Green) #}
        <a href="{% url 'checklists:checklist_perform' template_pk=template.pk %}"
           class="inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-full shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:bg-ios-green dark:hover:bg-green-500 dark:focus:ring-offset-dark-800 transition-all active:scale-95">
             <i class="fas fa-play mr-2"></i> {% trans 'Выполнить' %}
        </a>
        {# Edit Button (Yellow) #}
        <a href="{% url 'checklists:template_update' pk=template.pk %}"
           class="inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-full shadow-sm text-sm font-medium text-gray-900 bg-yellow-400 hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 dark:bg-ios-yellow dark:text-black dark:hover:bg-yellow-300 dark:focus:ring-offset-dark-800 transition-all active:scale-95">
            <i class="fas fa-edit mr-2"></i> {% trans 'Редактировать' %}
        </a>
        {# Back Button (Standard secondary/gray) #}
         <a href="{% url 'checklists:template_list' %}"
            class="inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-full shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-dark-700 dark:text-gray-300 dark:hover:bg-dark-600 dark:focus:ring-offset-dark-800 transition-all active:scale-95">
             <i class="fas fa-arrow-left mr-2"></i> {% trans 'К списку шаблонов' %}
        </a>
    </div>
</div>
{% endblock %}

{% block list_content %}
<div class="mt-6 space-y-6">
    {# Description Section #}
    {% if template.description %}
    <div class="bg-white dark:bg-dark-800 shadow rounded-lg border border-gray-200 dark:border-dark-700 p-6">
        <h2 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3">{% trans "Описание" %}</h2>
        <div class="prose prose-sm dark:prose-invert max-w-none text-gray-700 dark:text-gray-300">
            {{ template.description|linebreaksbr }}
        </div>
    </div>
    {% endif %}

    {# Items Section #}
    <div class="bg-white dark:bg-dark-800 shadow rounded-lg border border-gray-200 dark:border-dark-700 p-6">
        <h2 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">{% trans "Пункты чеклиста" %} ({{ template.items.count }})</h2>
        {% if template.items.all %}
        <ol class="space-y-3 text-gray-700 dark:text-gray-300 text-sm"> {# Changed to ol for ordered list #}
            {% for item in template.items.all %} {# Assumes items are ordered by 'order' field in model #}
            <li class="bg-gray-50 dark:bg-dark-700 p-3 rounded-md border border-gray-200 dark:border-dark-600 flex items-start">
               <span class="mr-3 font-mono text-xs text-gray-500 dark:text-gray-400 pt-0.5">{{ item.order }}.</span> {# Display order number #}
               <span class="flex-1">{{ item.item_text|linebreaksbr }}</span> {# Allow line breaks in item text #}
            </li>
            {% endfor %}
        </ol>
        {% else %}
        <p class="text-gray-500 dark:text-gray-400 italic">{% trans "В этом шаблоне пока нет пунктов." %}</p>
        {% endif %}
    </div>

</div>
{% endblock %}