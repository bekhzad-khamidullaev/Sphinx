{% load i18n static %}
<div class="result-item p-4 border border-gray-200 dark:border-dark-600 rounded-lg bg-gray-50 dark:bg-dark-700/50 flex flex-col md:flex-row md:items-start gap-4">
    <div class="flex-grow">
        <p class="text-sm font-medium text-gray-800 dark:text-gray-200 mb-1">
            {{ result.template_item.order }}. {{ result.template_item.item_text }}
        </p>
        <div class="text-xs text-gray-500 dark:text-gray-400 mt-1 space-x-2">
            {% if result.template_item.target_point %}
                <span title="{% trans 'Точка проверки' %}">
                    <i class="fas fa-map-marker-alt fa-fw text-gray-400" aria-hidden="true"></i>
                    {% trans "Точка" %}: {{ result.template_item.target_point.name }}
                </span>
            {% endif %}
            <span title="{% trans 'Тип ответа' %}">
                <i class="fas fa-tag fa-fw text-gray-400" aria-hidden="true"></i>
                {% trans "Тип" %}: {{ result.template_item.get_answer_type_display }}
            </span>
            {% if result.template_item.help_text %}
                <span title="{% trans 'Подсказка к вопросу' %}" class="italic">
                    <i class="fas fa-info-circle fa-fw text-gray-400" aria-hidden="true"></i>
                    {% trans "Подсказка" %}: {{ result.template_item.help_text }}
                </span>
            {% endif %}
        </div>
        {% if result.comments %}
            <p class="text-xs text-gray-600 dark:text-gray-400 mt-2 pl-4 border-l-2 border-gray-300 dark:border-dark-600 italic">
                <i class="fas fa-comment-dots fa-fw mr-1 text-gray-400" aria-hidden="true"></i>{{ result.comments }}
            </p>
        {% endif %}
    </div>
    <div class="flex-shrink-0 md:text-right space-y-1 text-sm text-gray-700 dark:text-gray-200">
        <div class="flex items-center justify-end space-x-2">
            {% if result.template_item.answer_type == 'file' and result.file_attachment %}
                <a href="{{ result.file_attachment.url }}" target="_blank" class="text-blue-600 hover:underline" title="{{ result.file_attachment.name }}">
                    <i class="fas fa-paperclip mr-1" aria-hidden="true"></i>
                    {{ result.file_attachment.name|cut:"checklist_files/"|truncatechars:20 }}
                </a>
            {% elif result.template_item.answer_type == 'url' and result.media_url %}
                <a href="{{ result.media_url }}" target="_blank" class="text-blue-600 hover:underline" title="{{ result.media_url }}">
                    <i class="fas fa-link mr-1" aria-hidden="true"></i> {% trans "Ссылка" %}
                </a>
            {% elif result.display_value %}
                {{ result.display_value|linebreaksbr }}
            {% else %}
                <span class="text-gray-400">-</span>
            {% endif %}
            <span class="status-badge px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full
                {% if result.status == 'ok' %}
                    bg-green-100 text-green-800 dark:bg-green-900/60 dark:text-green-200
                {% elif result.status == 'not_ok' %}
                    bg-red-100 text-red-800 dark:bg-red-900/60 dark:text-red-200
                {% elif result.status == 'na' %}
                    bg-gray-100 text-gray-500 dark:bg-dark-600 dark:text-gray-400
                {% else %}
                    bg-yellow-100 text-yellow-800 dark:bg-yellow-900/60 dark:text-yellow-200
                {% endif %}">
                {{ result.get_status_display }}
            </span>
        </div>
        {% if result.status == 'not_ok' and result.is_corrected %}
            <span class="status-badge px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/60 dark:text-blue-200">
                <i class="fas fa-wrench mr-1" aria-hidden="true"></i> {% trans "Исправлено" %}
            </span>
        {% endif %}
    </div>
</div>